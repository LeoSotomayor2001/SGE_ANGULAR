<div class="relative">
  <div
    class="absolute inset-x-0 top-0 transform -translate-y-1/2 bg-gradient-to-r from-indigo-900 via-purple-800 to-pink-700 text-white px-4 py-2 rounded-t-lg dark:from-indigo-700 dark:via-purple-600 dark:to-pink-500 dark:hover:from-indigo-600 dark:hover:via-purple-500 dark:hover:to-pink-400"
  >
    <h1 class="text-2xl font-bold text-center">Iniciar Sesión</h1>
  </div>
  <form
    class="bg-white p-6 rounded-lg shadow-xl mt-2 dark:bg-gray-800 dark:shadow-none dark:border dark:border-gray-700"
    [formGroup]="loginForm"
    (ngSubmit)="onSubmit()"
    autocomplete="off"
  >
    <div class="mt-4">
      <div *ngIf="backendFail " class="text-red-500 text-xs mt-1 text-center bg-red-500 p-3">
         <span class="text-white text-sm">{{ backendFail }}</span>
      </div>
      <div class="my-2">
        <label
          class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1"
          for="email"
        >
          Correo Electrónico
        </label>
        <input
          id="email"
          type="email"
          formControlName="email"
          class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-white"
          [class.border-red-500]="formUtils.isValidField(loginForm,'email')"
        />
        <div
          *ngIf="formUtils.isValidField(loginForm,'email')"
          class="text-red-500 text-xs mt-1"
        >
         {{formUtils.getFieldError(loginForm,'email')}}
        </div>
        <app-error-message [errors]="backendErrors['email']"></app-error-message>
      </div>
      <div class="my-2">
        <label
          class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1"
          for="password"
        >
          Contraseña
        </label>
        <input
          id="password"
          type="password"
          formControlName="password"
          class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-white"
          [class.border-red-500]="formUtils.isValidField(loginForm,'password') "
        />
        <div
          *ngIf="formUtils.isValidField(loginForm,'password') "
          class="text-red-500 text-xs mt-1"
        >
          {{formUtils.getFieldError(loginForm,'password')}}
        </div>
         <app-error-message [errors]="backendErrors['password']"></app-error-message>
      </div>
      <div class="my-2">
        <label
          class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1"
          for="user_type"
        >
          Tipo de Usuario
        </label>
        <select
          id="user_type"
          formControlName="user_type"
          class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-white"
          [class.border-red-500]="
            loginForm.get('user_type')?.invalid &&
            loginForm.get('user_type')?.touched
          "
        >
          <option value="" disabled selected>Seleccione un tipo</option>
          <option value="representante">Representante</option>
          <option value="administrador">Administrador</option>
          <option value="profesor">Profesor</option>
        </select>
        <div
          *ngIf="formUtils.isValidField(loginForm,'user_type')  "
          class="text-red-500 text-xs mt-1"
        >
             {{formUtils.getFieldError(loginForm,'user_type')}}
        </div>
         <app-error-message [errors]="backendErrors['user_type']"></app-error-message>
      </div>
    </div>

    <button
      type="submit"
      class="bg-gradient-to-r mt-2 from-indigo-900 via-purple-800 to-pink-700 w-full p-3 text-white uppercase font-bold rounded-lg transition-colors duration-200 hover:bg-indigo-700 cursor-pointer disabled:cursor-not-allowed disabled:bg-gray-400 disabled:opacity-50 dark:from-indigo-700 dark:via-purple-600 dark:to-pink-500 dark:hover:from-indigo-600 dark:hover:via-purple-500 dark:hover:to-pink-400"
    >
      <span *ngIf="isSubmitting" class="flex items-center justify-center">
        <span
          class="animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"
        ></span>
        Ingresando...
      </span>
      <span>Ingresar</span>
    </button>

    <a
      routerLink="/auth/register"
      class="block text-center my-3 text-indigo-600 dark:text-indigo-400 dark:hover:text-indigo-300"
    >
      ¿No tienes cuenta? Regístrate.
    </a>
    <a
      routerLink="/auth/recuperar-password"
      class="block text-center my-3 text-indigo-600 dark:text-indigo-400 dark:hover:text-indigo-300"
    >
      ¿Olvidaste tu contraseña? Recupérala aquí.
    </a>
  </form>
</div>
